var documenterSearchIndex = {"docs":
[{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"EditURL = \"https://github.com/RemoteSensingTools/vSmartMOM.jl/blob/main/docs/src/pages/tutorials/Tutorial_Scattering.jl\"","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/#Scattering:-Mie-Phase-Function-Tutorial","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Scattering/#Introduction","page":"Scattering: Mie Phase Function Tutorial","title":"Introduction","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"In the following tutorial, we will walk through how to compute phase function matrices from Mie theory.","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"Along the way, we will also calculate greek coefficients (which are essentially the legendre decomposition of the phase matrix components), which will be required for radiative transfer calculations.","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/#Performing-the-phase-function-calculations","page":"Scattering: Mie Phase Function Tutorial","title":"Performing the phase function calculations","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"First let's use the required packages","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"using vSmartMOM.Scattering\nusing Distributions\nusing Plots","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"Now, we define the aerosol size distribution and properties. We only support univariate aerosols for now, but will add multivariate aerosols soon (we can use mixture models easily).","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"rₘ    = 0.3;             ## median radius [μm]\nσ     = 2.0;             ## geometric stddev of radius\nnᵣ    = 1.3;             ## Real part of refractive index\nnᵢ    = 0.0;             ## Imag part of refractive index (sign changed, use only + here)\nr_max = 30.0;            ## Maximum radius [μm]\nnquad_radius  = 2500;    ## Number of quadrature points for integrating of size dist.\n\n# Create a Size Distribution (using Julia's Distributions package), note we have to take the natural log here\nsize_distribution = LogNormal(log(rₘ), log(σ));\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"Create the aerosol with distribution and refractive index","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"aero = Aerosol(size_distribution, nᵣ, nᵢ)","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"Now, we define some scattering and truncation properties:","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"λ = 0.55;                             ## Incident wavelength [μm]\npolarization_type = Stokes_IQUV();    ## Polarization type\n\n# Trunction length for legendre terms\nl_max = 20;\n\n# Exclusion angle for forward peak (in fitting procedure) `[degrees]`\nΔ_angle = 2;\n\n# Truncation type\ntruncation_type   = δBGE(l_max, Δ_angle);\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"# Create a Mie model, using the Siewert method NAI2\nmodel_NAI2 = make_mie_model(NAI2(), aero, λ, polarization_type, truncation_type, r_max, nquad_radius);\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"# Compute aerosol optical properties:\naerosol_optics_NAI2 = compute_aerosol_optical_properties(model_NAI2);\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/#Plotting-the-greek-coefficients","page":"Scattering: Mie Phase Function Tutorial","title":"Plotting the greek coefficients","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"(These are basically giving us the legendre decomposition of the phase matrix components)","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"using Parameters\n@unpack α,β,γ,δ,ϵ,ζ = aerosol_optics_NAI2.greek_coefs;\np1 = plot(α,  title=\"α\");\np2 = plot(β,  title=\"β\");\np3 = plot(γ,  title=\"γ\");\np4 = plot(δ,  title=\"δ\");\np5 = plot(ϵ,  title=\"ϵ\");\np6 = plot(ζ,  title=\"ζ\");\nplot(p1, p2, p3, p4, p5, p6, layout=(3, 2), legend=false)\nxlims!(0,100)","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"Here, we can see the different greek coefficients that will be needed to compute the entire phase matrix at a given Fourier moment (see Sanghavi, Suniti. \"Revisiting the Fourier expansion of Mie scattering matrices in generalized spherical functions.\" Journal of Quantitative Spectroscopy and Radiative Transfer 136 (2014) for details).","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/#Reconstructing-the-Phase-Functions-from-the-greek-coefficients","page":"Scattering: Mie Phase Function Tutorial","title":"Reconstructing the Phase Functions from the greek coefficients","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"using FastGaussQuadrature\nμ_quad, w_μ = gausslegendre(1000)\nscattering_matrix = Scattering.reconstruct_phase(aerosol_optics_NAI2.greek_coefs, μ_quad);\n@unpack f₁₁, f₁₂, f₂₂, f₃₃, f₃₄, f₄₄ = scattering_matrix","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"Plot only phase function for I (f₁₁) and the I -> Q transition in the phase matrix (f₁₂) for the Stokes Vector [I,Q,U,V]","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"p1 = plot(μ_quad, f₁₁, yscale=:log10, title=\"f₁₁\")\np2 = plot(μ_quad, f₁₂ ./ f₁₁,  title=\"f₁₂/f₁₁\")\n\nplot(p1, p2, layout=(2, 1), legend=false)\nxlabel!(\"cos(Θ)\")","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"The top panel represents a more traditional phase function just for intensity, in this case high forward peaked (at μ=1). The lower panel shows the degree of linear polarization (f₁₂/f₁₁) associated with the scattering direction.","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"p1 = plot([acos.(μ_quad); -reverse(acos.(μ_quad))], log10.([f₁₁ ; reverse(f₁₁)]), proj=:polar, yscale=:log10, title=\"f₁₁\", lims=(-3,4.2), yaxis=false)\np2 = plot([acos.(μ_quad); -reverse(acos.(μ_quad))], [abs.(f₁₂ ./ f₁₁) ; reverse(f₁₂ ./ f₁₁)], proj=:polar, title=\"f₁₂/f₁₁\", lims=(0,0.6), yaxis=false)\n\nplot(p1, p2, layout=(1, 2), legend=false)\nxlabel!(\"Θ\")","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"This figures shows the same as above but as polar plot with Θ=0 being the forward direction, Θ=180 the backward direction. The left panel is in log-scale while the right one show the degree of linear polarization (in absolute terms).","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"anim = @animate for r = 0.03:0.05:4.3\n    @show r\n    local size_distribution = LogNormal(log(r), log(σ))\n    # Create the aerosol\n    local aero       = Aerosol(size_distribution, nᵣ, nᵢ)\n    local model_NAI2 = make_mie_model(NAI2(), aero, λ, polarization_type, truncation_type, r_max, nquad_radius)\n    local aerosol_optics_NAI2 = compute_aerosol_optical_properties(model_NAI2);\n    local scattering_matrix = Scattering.reconstruct_phase(aerosol_optics_NAI2.greek_coefs, μ_quad);\n    @unpack f₁₁, f₁₂, f₂₂, f₃₃, f₃₄, f₄₄ = scattering_matrix\n    # @show f₁₁[1]\n\n    p1 = plot(μ_quad, f₁₁, yscale=:log10, title=\"f₁₁\", label=\"r(μm)=$r\")\n    ylims!(1e-3, 1e3)\n    p2 = plot(μ_quad, f₁₂ ./ f₁₁,  title=\"f₁₂/f₁₁\", label=\"Q/I\")\n    ylims!(-1.1, 1.1)\n    plot(p1, p2, layout=(2, 1))\n\n    p3 = plot([acos.(μ_quad); -reverse(acos.(μ_quad))], log10.([f₁₁ ; reverse(f₁₁)]), proj=:polar, yscale=:log10, title=\"f₁₁, r = $(r)μm\", lims=(-3,4.2), yaxis=false)\n    p4 = plot([acos.(μ_quad); -reverse(acos.(μ_quad))], [f₁₂ ./ f₁₁ ; reverse(f₁₂ ./ f₁₁)], proj=:polar, title=\"f₁₂/f₁₁, r = $(r)μm\", lims=(0,1.0), yaxis=false)\n\n    plot(plot(p1, p2, layout=(2,1), legend=false), plot(p3, p4, layout=(1,2), legend=false), layout=(2, 1), legend=false)\n\n    plot!(size=(600,800))\n\nend\ngif(anim, fps = 5)","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"This animation shows how the phase function and polarization properties vary with the mean radius of the aerosol distribution (width is fixed).","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"","category":"page"},{"location":"pages/tutorials/Tutorial_Scattering/","page":"Scattering: Mie Phase Function Tutorial","title":"Scattering: Mie Phase Function Tutorial","text":"This page was generated using Literate.jl.","category":"page"},{"location":"pages/Scattering/Types/#Scattering-Module-Methods-and-Types","page":"Methods & Types","title":"Scattering Module Methods & Types","text":"","category":"section"},{"location":"pages/Scattering/Types/#Defining-the-Mie-Computation-Model","page":"Methods & Types","title":"Defining the Mie Computation Model","text":"","category":"section"},{"location":"pages/Scattering/Types/","page":"Methods & Types","title":"Methods & Types","text":"make_mie_model","category":"page"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.make_mie_model","page":"Methods & Types","title":"vSmartMOM.Scattering.make_mie_model","text":"make_mie_model(computation_type::NAI2, aerosol::AbstractAerosolType, λ::Real, polarization::AbstractPolarizationType, truncation_type::AbstractTruncationType)\n\nConvenience function to create Mie Model with NAI2 computation type \n\n\n\n\n\nmake_mie_model(computation_type::PCW, aerosol::AbstractAerosolType, λ::Real, polarization::AbstractPolarizationType, truncation_type::AbstractTruncationType, wigner_filepath::String)\n\nConvenience function to load Wigner matrices from file and create Mie Model with PCW computation type \n\n\n\n\n\nmake_mie_model(computation_type::PCW, aerosol::AbstractAerosolType, λ::Real, polarization::AbstractPolarizationType, truncation_type::AbstractTruncationType, wigner_A, wigner_B)\n\nConvenience function to take in Wigner matrices and create Mie Model with PCW computation type \n\n\n\n\n\n","category":"function"},{"location":"pages/Scattering/Types/#Creating/Saving-Wigner-Matrices-(if-using-PCW-method)","page":"Methods & Types","title":"Creating/Saving Wigner Matrices (if using PCW method)","text":"","category":"section"},{"location":"pages/Scattering/Types/","page":"Methods & Types","title":"Methods & Types","text":"compute_wigner_values\nsave_wigner_values\nload_wigner_values","category":"page"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.compute_wigner_values","page":"Methods & Types","title":"vSmartMOM.Scattering.compute_wigner_values","text":"compute_wigner_values(m_max::Integer, n_max::Integer, l_max::Integer)\n\nCompute the Wigner 3j values for all (m, n, l) combinations up to m/n/l max, for  (m1, m2, m3) = (-1, 1, 0) (wignerA) and (-1, -1, 2) (wignerB)\n\n\n\n\n\ncompute_wigner_values(N_max)\n\nShorthand for computewignervalues(2Nmax + 1, Nmax + 1, 2N_max + 1)\n\n\n\n\n\n","category":"function"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.save_wigner_values","page":"Methods & Types","title":"vSmartMOM.Scattering.save_wigner_values","text":"save_wigner_values(filepath, wigner_A, wigner_B)\n\nSave the Wigner A and Wigner B matrices at the given filepath\n\n\n\n\n\n","category":"function"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.load_wigner_values","page":"Methods & Types","title":"vSmartMOM.Scattering.load_wigner_values","text":"load_wigner_values(filename)\n\nLoad the Wigner A and Wigner B matrices from the given filepath\n\n\n\n\n\n","category":"function"},{"location":"pages/Scattering/Types/#Computing-Aerosol-Optical-Properties","page":"Methods & Types","title":"Computing Aerosol Optical Properties","text":"","category":"section"},{"location":"pages/Scattering/Types/","page":"Methods & Types","title":"Methods & Types","text":"compute_aerosol_optical_properties","category":"page"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.compute_aerosol_optical_properties","page":"Methods & Types","title":"vSmartMOM.Scattering.compute_aerosol_optical_properties","text":"compute_aerosol_optical_properties(model::MieModel{FDT}) where FDT<:NAI2\n\nReference: Suniti Sanghavi 2014, https://doi.org/10.1016/j.jqsrt.2013.12.015\n\nCompute the aerosol optical properties using the Siewert-NAI2 method Input: MieModel, holding all computation and aerosol properties  Output: AerosolOptics, holding all Greek coefficients and Cross-Sectional information\n\n\n\n\n\ncompute_aerosol_optical_properties(model::MieModel{FDT}) where FDT<:PCW\n\nReference: Suniti Sanghavi 2014, https://doi.org/10.1016/j.jqsrt.2013.12.015\n\nCompute the aerosol optical properties using the Domke-PCW method  Input: MieModel, holding all computation and aerosol properties  Output: AerosolOptics, holding all Greek coefficients and Cross-Sectional information\n\n\n\n\n\ncompute_aerosol_optical_properties(model::MieModel{FDT})\n\nReference: Suniti Sanghavi 2014, https://doi.org/10.1016/j.jqsrt.2013.12.015\n\nThis function enables user to specify whether to perform auto-differentiation (using either computation type) Input: MieModel, holding all computation and aerosol properties & autodiff flag (whether to perform  auto-differentiation) Output: AerosolOptics, holding all Greek coefficients and Cross-Sectional information\n\n\n\n\n\n","category":"function"},{"location":"pages/Scattering/Types/#Reconstructing-Phase-Function","page":"Methods & Types","title":"Reconstructing Phase Function","text":"","category":"section"},{"location":"pages/Scattering/Types/","page":"Methods & Types","title":"Methods & Types","text":"reconstruct_phase","category":"page"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.reconstruct_phase","page":"Methods & Types","title":"vSmartMOM.Scattering.reconstruct_phase","text":"$(FUNCTIONNAME)(greek_coefs, μ; returnLeg = false)\n\nReturns the reconstructed elements of the 4x4 scattering matrix at positions  f₁₁, f₁₂, f₂₂, f₃₃, f₃₄, f₄₄ from the greek coefficients\n\nf₁₁ represents the phase function p for the Intensity (first Stokes Vector element) and is normalized as follows:\n\nfrac14piint_0^2pidphi int_-1^1 p(mu) dmu  = 1\n\ngreek_coefs greek coefficients (Domke Type)\nreturnLeg if false (default), just return f₁₁, f₁₂, f₂₂, f₃₃, f₃₄, f₄₄, if true, \nreturn f₁₁, f₁₂, f₂₂, f₃₃, f₃₄, f₄₄, P, P² (i.e. also the two legendre polynomials as matrices)\n\n\n\n\n\n","category":"function"},{"location":"pages/Scattering/Types/#Types","page":"Methods & Types","title":"Types","text":"","category":"section"},{"location":"pages/Scattering/Types/#Aerosol-Types","page":"Methods & Types","title":"Aerosol Types","text":"","category":"section"},{"location":"pages/Scattering/Types/","page":"Methods & Types","title":"Methods & Types","text":"Aerosol","category":"page"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.Aerosol","page":"Methods & Types","title":"vSmartMOM.Scattering.Aerosol","text":"Aerosol type with its properties (size distribution and refractive index)\n\n\n\n\n\n","category":"type"},{"location":"pages/Scattering/Types/#Fourier-Decomposition-Computation-Types","page":"Methods & Types","title":"Fourier Decomposition Computation Types","text":"","category":"section"},{"location":"pages/Scattering/Types/","page":"Methods & Types","title":"Methods & Types","text":"NAI2\nPCW","category":"page"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.NAI2","page":"Methods & Types","title":"vSmartMOM.Scattering.NAI2","text":"type NAI2\n\nPerform Siewart's numerical integration method, NAI-2, to compute aerosol phase function  decomposition. See: http://adsabs.harvard.edu/full/1982A%26A...109..195S\n\n\n\n\n\n","category":"type"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.PCW","page":"Methods & Types","title":"vSmartMOM.Scattering.PCW","text":"type PCW\n\nPerform Domke's Precomputed Wigner Symbols method, PCW, to compute aerosol phase function  decomposition. See: http://adsabs.harvard.edu/full/1984A%26A...131..237D\n\n\n\n\n\n","category":"type"},{"location":"pages/Scattering/Types/#Polarization-Types","page":"Methods & Types","title":"Polarization Types","text":"","category":"section"},{"location":"pages/Scattering/Types/","page":"Methods & Types","title":"Methods & Types","text":"Stokes_IQUV\nStokes_IQU\nStokes_I","category":"page"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.Stokes_IQUV","page":"Methods & Types","title":"vSmartMOM.Scattering.Stokes_IQUV","text":"struct Stokes_IQUV{FT<:AbstractFloat}\n\nA struct which defines full Stokes Vector ([I,Q,U,V]) RT code\n\nFields\n\nn\nNumber of Stokes components (int)\nD\nVector of length n for ... (see eq in Sanghavi )\nI₀\nIncoming Stokes vector for scalar only\n\n\n\n\n\n","category":"type"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.Stokes_IQU","page":"Methods & Types","title":"vSmartMOM.Scattering.Stokes_IQU","text":"struct Stokes_IQU{FT<:AbstractFloat}\n\nA struct which defines Stokes Vector ([I,Q,U]) RT code\n\nFields\n\nn\nNumber of Stokes components (int)\nD\nVector of length n for ... (see eq in Sanghavi )\nI₀\nIncoming Stokes vector for scalar only\n\n\n\n\n\n","category":"type"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.Stokes_I","page":"Methods & Types","title":"vSmartMOM.Scattering.Stokes_I","text":"struct Stokes_I{FT<:AbstractFloat}\n\nA struct which define scalar I only RT code\n\nFields\n\nn\nNumber of Stokes components (int)\nD\nVector of length n for ... (see eq in Sanghavi )\nI₀\nIncoming Stokes vector for scalar only\n\n\n\n\n\n","category":"type"},{"location":"pages/Scattering/Types/#Truncation-Types","page":"Methods & Types","title":"Truncation Types","text":"","category":"section"},{"location":"pages/Scattering/Types/","page":"Methods & Types","title":"Methods & Types","text":"δBGE","category":"page"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.δBGE","page":"Methods & Types","title":"vSmartMOM.Scattering.δBGE","text":"type δBGE{FT} <: AbstractTruncationType\n\nFields\n\nl_max\nTrunction length for legendre terms\nΔ_angle\nExclusion angle for forward peak (in fitting procedure) [degrees]\n\n\n\n\n\n","category":"type"},{"location":"pages/Scattering/Types/#Mie-Computation-Model-Type","page":"Methods & Types","title":"Mie Computation Model Type","text":"","category":"section"},{"location":"pages/Scattering/Types/","page":"Methods & Types","title":"Methods & Types","text":"MieModel","category":"page"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.MieModel","page":"Methods & Types","title":"vSmartMOM.Scattering.MieModel","text":"type MieModel\n\nModel to hold all Mie computation details for NAI2 and PCW\n\nFields\n\ncomputation_type\naerosol\nλ\npolarization_type\ntruncation_type\nr_max\nMaximum radius [μm]\nnquad_radius\nNumber of quadrature points for integration over size distribution\nwigner_A\nwigner_B\n\n\n\n\n\n","category":"type"},{"location":"pages/Scattering/Types/#Output-Aerosol-Optics-Types","page":"Methods & Types","title":"Output Aerosol Optics Types","text":"","category":"section"},{"location":"pages/Scattering/Types/","page":"Methods & Types","title":"Methods & Types","text":"GreekCoefs\nAerosolOptics","category":"page"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.GreekCoefs","page":"Methods & Types","title":"vSmartMOM.Scattering.GreekCoefs","text":"struct GreekCoefs{FT}\n\nA struct which holds all Greek coefficient lists (over l) in one object.  See eq 16 in Sanghavi 2014 for details. \n\nFields\n\nα\nGreek matrix coefficient α, is in B[2,2]\nβ\nGreek matrix coefficient β, is in B1,1\nγ\nGreek matrix coefficient γ, is in B[2,1],B[1,2]\nδ\nGreek matrix coefficient δ, is in B[4,4]\nϵ\nGreek matrix coefficient ϵ, is in B[3,4] and - in B[4,3]\nζ\nGreek matrix coefficient ζ, is in B[3,3]\n\n\n\n\n\n","category":"type"},{"location":"pages/Scattering/Types/#vSmartMOM.Scattering.AerosolOptics","page":"Methods & Types","title":"vSmartMOM.Scattering.AerosolOptics","text":"struct AerosolOptics\n\nA struct which holds all computed aerosol optics\n\nFields\n\ngreek_coefs\nGreek matrix\nω̃\nSingle Scattering Albedo\nk\nExtinction cross-section\nfᵗ\nTruncation factor\nderivs\nDerivatives\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#Absorption-Module-Methods-and-Types","page":"Methods & Types","title":"Absorption Module Methods & Types","text":"","category":"section"},{"location":"pages/Absorption/Types/#Downloading-HITRAN-Data","page":"Methods & Types","title":"Downloading HITRAN Data","text":"","category":"section"},{"location":"pages/Absorption/Types/","page":"Methods & Types","title":"Methods & Types","text":"artifact","category":"page"},{"location":"pages/Absorption/Types/#vSmartMOM.artifact","page":"Methods & Types","title":"vSmartMOM.artifact","text":"artifact(molecule::AbstractString, database::AbstractString = \"hitran\")\n\nGiven a molecule name and a database name, retrieve the transition file \n\n\n\n\n\n","category":"function"},{"location":"pages/Absorption/Types/#Reading-HITRAN-Files","page":"Methods & Types","title":"Reading HITRAN Files","text":"","category":"section"},{"location":"pages/Absorption/Types/","page":"Methods & Types","title":"Methods & Types","text":"read_hitran","category":"page"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.read_hitran","page":"Methods & Types","title":"vSmartMOM.Absorption.read_hitran","text":"read_hitran(filepath::String, mol::Int=-1, iso::Int=-1, ν_min::Real=0, ν_max::Real=Inf)\n\nRead/parse a HITRAN data file and return the data in HitranTable format\n\n\n\n\n\n","category":"function"},{"location":"pages/Absorption/Types/#Defining-Models-with-Cross-Section-Parameters","page":"Methods & Types","title":"Defining Models with Cross-Section Parameters","text":"","category":"section"},{"location":"pages/Absorption/Types/","page":"Methods & Types","title":"Methods & Types","text":"make_hitran_model\nmake_interpolation_model","category":"page"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.make_hitran_model","page":"Methods & Types","title":"vSmartMOM.Absorption.make_hitran_model","text":"make_hitran_model(hitran::HitranTable, \n                  broadening::AbstractBroadeningFunction; \n                  wing_cutoff::Real=40, \n                  vmr::Real=0, \n                  CEF::AbstractComplexErrorFunction=HumlicekWeidemann32SDErrorFunction(), \n                  architecture = default_architecture)\n\nConvenience function to make a HitranModel out of the parameters (Matches makeinterpolationmodel)\n\n\n\n\n\n","category":"function"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.make_interpolation_model","page":"Methods & Types","title":"vSmartMOM.Absorption.make_interpolation_model","text":"make_interpolation_model(hitran::HitranTable, \n                broadening::AbstractBroadeningFunction, \n                wave_grid::AbstractRange{<:Real}, \n                p_grid::AbstractRange{<:Real},\n                t_grid::AbstractRange{<:Real}; \n                wavelength_flag::Bool=false,\n                wing_cutoff::Real=40, \n                vmr::Real=0, \n                CEF::AbstractComplexErrorFunction=HumlicekWeidemann32SDErrorFunction(),\n                architecture::AbstractArchitecture=default_architecture )\n\nUsing a HitranModel, create an InterpolationModel by interpolating the lineshape function  at the given pressure and temperature grids\n\n\n\n\n\n","category":"function"},{"location":"pages/Absorption/Types/#Computing-Absorption-Cross-Sections","page":"Methods & Types","title":"Computing Absorption Cross-Sections","text":"","category":"section"},{"location":"pages/Absorption/Types/","page":"Methods & Types","title":"Methods & Types","text":"absorption_cross_section","category":"page"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.absorption_cross_section","page":"Methods & Types","title":"vSmartMOM.Absorption.absorption_cross_section","text":"absorption_cross_section(model::HitranModel, grid::AbstractRange{<:Real}, pressure::Real, temperature::Real; wavelength_flag::Bool=false)\n\nCalculate absorption cross-section at the given pressure, temperature, and grid of wavelengths  (or wavenumbers), and have the option to perform auto-differentiation\n\n\n\n\n\n","category":"function"},{"location":"pages/Absorption/Types/#Types","page":"Methods & Types","title":"Types","text":"","category":"section"},{"location":"pages/Absorption/Types/#Hitran-Data-Structure-Type","page":"Methods & Types","title":"Hitran Data Structure Type","text":"","category":"section"},{"location":"pages/Absorption/Types/","page":"Methods & Types","title":"Methods & Types","text":"HitranTable","category":"page"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.HitranTable","page":"Methods & Types","title":"vSmartMOM.Absorption.HitranTable","text":"struct HitranTable{FT}\n\nA struct, which provides all HITRAN line parameters needed to compute  absorption cross sections\n\nSee https://hitran.org/docs/definitions-and-units/ for details\n\nFields\n\nmol\nThe molecular species identification (ID) number\niso\nThe isotopologue ID number\nνᵢ\nThe wavenumber of the spectral line transition (cm-1) in vacuum\nSᵢ\nThe spectral line intensity (cm−1/(molecule·cm−2)) at Tref=296K\nAᵢ\nThe Einstein-A coefficient (s-1) of a transition\nγ_air\nThe air-broadened half width at half maximum (HWHM) (cm−1/atm) at Tref=296K and reference pressure pref=1atm\nγ_self\nThe self-broadened half width at half maximum (HWHM) (cm−1/atm) at Tref=296K and reference pressure pref=1atm\nE″\nThe lower-state energy of the transition (cm-1)\nn_air\nThe coefficient of the temperature dependence of the air-broadened half width\nδ_air\nThe pressure shift (cm−1/atm) at Tref=296K and pref=1atm of the line position with respect to the vacuum transition wavenumber νij\nglobal_upper_quanta\nThe electronic and vibrational quantum numbers and labels for the upper state of a transition\nglobal_lower_quanta\nThe electronic and vibrational quantum numbers and labels for the lower state of a transition\nlocal_upper_quanta\nRotational, hyperfine and other quantum numbers and labels for the upper state of a transition\nlocal_lower_quanta\nRotational, hyperfine and other quantum numbers and labels for the lower state of a transition\nierr\nOrdered list of indices corresponding to uncertainty estimates of transition parameters\niref\nOrdered list of reference identifiers for transition parameters\nline_mixing_flag\nA flag indicating the presence of additional data and code relating to line-mixing\ng′\nThe upper state degeneracy\ng″\nThe lower state degeneracy\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#Broadening-Function-Types","page":"Methods & Types","title":"Broadening Function Types","text":"","category":"section"},{"location":"pages/Absorption/Types/","page":"Methods & Types","title":"Methods & Types","text":"Doppler\nLorentz\nVoigt","category":"page"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.Doppler","page":"Methods & Types","title":"vSmartMOM.Absorption.Doppler","text":"Doppler line broadening\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.Lorentz","page":"Methods & Types","title":"vSmartMOM.Absorption.Lorentz","text":"Lorentz line broadening\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.Voigt","page":"Methods & Types","title":"vSmartMOM.Absorption.Voigt","text":"Voigt line broadening\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#Complex-Error-Function-Types","page":"Methods & Types","title":"Complex Error Function Types","text":"","category":"section"},{"location":"pages/Absorption/Types/","page":"Methods & Types","title":"Methods & Types","text":"HumlicekErrorFunction\nHumlicekWeidemann32VoigtErrorFunction\nHumlicekWeidemann32SDErrorFunction\nCPF12ErrorFunction\nErfcHumliErrorFunctionVoigt\nErfcHumliErrorFunctionSD\nErfcErrorFunction","category":"page"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.HumlicekErrorFunction","page":"Methods & Types","title":"vSmartMOM.Absorption.HumlicekErrorFunction","text":"Humlicek only formulation for Complex Error Function\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.HumlicekWeidemann32VoigtErrorFunction","page":"Methods & Types","title":"vSmartMOM.Absorption.HumlicekWeidemann32VoigtErrorFunction","text":"Mix of Humlicek and Weidemann (N=32) Error Function, suggested for Voigt function\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.HumlicekWeidemann32SDErrorFunction","page":"Methods & Types","title":"vSmartMOM.Absorption.HumlicekWeidemann32SDErrorFunction","text":"Mix of Humlicek and Weidemann (N=32) Error Function, suggested for Speed Dependent Voigt function\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.CPF12ErrorFunction","page":"Methods & Types","title":"vSmartMOM.Absorption.CPF12ErrorFunction","text":"Humlicek with a single rational approximation.\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.ErfcHumliErrorFunctionVoigt","page":"Methods & Types","title":"vSmartMOM.Absorption.ErfcHumliErrorFunctionVoigt","text":"Mix of Humplicek and erfc Special Function for Voigt\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.ErfcHumliErrorFunctionSD","page":"Methods & Types","title":"vSmartMOM.Absorption.ErfcHumliErrorFunctionSD","text":"Mix of Humplicek and erfc Special Function for Voigt\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.ErfcErrorFunction","page":"Methods & Types","title":"vSmartMOM.Absorption.ErfcErrorFunction","text":"erfc Special Function for Voigt\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#Cross-Section-Model-Types","page":"Methods & Types","title":"Cross-Section Model Types","text":"","category":"section"},{"location":"pages/Absorption/Types/","page":"Methods & Types","title":"Methods & Types","text":"HitranModel\nInterpolationModel","category":"page"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.HitranModel","page":"Methods & Types","title":"vSmartMOM.Absorption.HitranModel","text":"struct HitranModel{FT}\n\nA struct which provides all model parameters needed for cross-section  calculations using HITRAN data\n\nFields\n\nhitran\nStruct with hitran data\nbroadening\nBroadening function (Doppler/Lorentz/Voigt)\nwing_cutoff\nWing cutoff [cm-1]\nvmr\nVMR of gas itself [0-1]\nCEF\nComplex Error Function to Use\narchitecture\nComputer Architecture on which Model is run\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/Types/#vSmartMOM.Absorption.InterpolationModel","page":"Methods & Types","title":"vSmartMOM.Absorption.InterpolationModel","text":"struct InterpolationModel{FT}\n\nA struct which provides all model parameters needed for cross-section  calculations using an Interpolator\n\nFields\n\nitp\nThe interpolator\nmol\nThe molecular species identification (ID) number\niso\nThe isotopologue ID number\nν_grid\nWavelength grids\np_grid\nWavelength grids\nt_grid\nWavelength grids\n\n\n\n\n\n","category":"type"},{"location":"pages/Scattering/References/#Scattering-Module-References","page":"References","title":"Scattering Module References","text":"","category":"section"},{"location":"pages/Scattering/References/","page":"References","title":"References","text":"1. Domke, H., 1975. Fourier expansion of the phase matrix for Mie scattering. Zeitschrift für \nMeteorologie, 25(6), pp.357-361.\n\n2. Siewert, C.E., 1982. On the phase matrix basic to the scattering of polarized light. \nAstronomy and Astrophysics, 109, p.195.\n\n3. Sanghavi, S., 2014. Revisiting the Fourier expansion of Mie scattering matrices in \ngeneralized spherical functions. Journal of Quantitative Spectroscopy and Radiative Transfer, \n136, pp.16-27.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"EditURL = \"https://github.com/RemoteSensingTools/vSmartMOM.jl/blob/main/docs/src/pages/tutorials/Tutorial_Absorption.jl\"","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#Absorption:-Spectral-Line-Shapes","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"The purpose of this tutorial is to demonstrate how to compute line-shapes using the vSmartMOM Julia package. Here, we focus on rotational-vibrational transition lines, what processes determine line-shapes, and how the line-shapes depend on pressure and temperature.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#Basic-Tools","page":"Absorption: Spectral Line Shapes","title":"Basic Tools","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"We are making use of the HITRAN database, see a list of tutorials here.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"There are other spectroscopic linelists, but we are focusing on HITRAN only here. In addition, there are more complex line-shapes that we are not treating here, including collisional narrowing and line-mixing, collision-induced absorption (CIA). In the future, these might be added to vSmartMOM.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#Line-shape:","page":"Absorption: Spectral Line Shapes","title":"Line-shape:","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"If we have a line-strength S (in cm^-1 cm^2/molecule) for a specific transition at nu_0, we can compute the cross section as:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"sigma(nu) = S cdot Phi(nu-nu_0)","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"where Phi(nu-nu_0) denotes the line-shape function (in 1/cm^-1), which is normalized to 1:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"int_-infty^infty Phi(nu-nu_0) dnu=1","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"There are several processes that affect the shape and width of Phi, and we will walk through the most important ones here.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#Doppler-Broadening","page":"Absorption: Spectral Line Shapes","title":"Doppler Broadening","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Doppler broadening is caused by a simple doppler shift of emitted and absorbed frequencies, caused by the relative velocities of the molecules along the line of sight. A doppler shifted apparent frequency from the centroid frequency nu_0 can be described as:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"nu = nu_0left(1+fracv_rcright)","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"where v_r is the relative velocity of the absorbing photon along the line of sight. The doppler shift is then simply","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Deltanu = nu_0fracv_rc","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Let us take a simple example with the satellite flying at 7km/s and either staring into the flight direction (technically, it wouldn't see the atmosphere then, but let's ignore this) or looking into the back:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"____","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"# Speed of light (in m/s)\nc = 299792458.0\n\n# Relative velocity (in m/s)\nvᵣ = 7000.0\n\n# Center wavenumber (say 1600nm, which is 1e7/1600=6250 cm$^{-1}$)\nv₀ = 6250.0\n\n# Doppler shift:\nΔ_ν = ( v₀ * vᵣ) / c\n\n# Just writing out doppler shift in wavenumbers and wavelengths\nprintln(\"Doppler shift = $Δ_ν cm-1\")\nprintln(\"Doppler shift = $(1e7/(v₀-Δ_ν)-1e7/v₀) nm\")","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#Random-movements-of-molecules-in-gases-lead-to-doppler-broadening-effects","page":"Absorption: Spectral Line Shapes","title":"Random movements of molecules in gases lead to doppler broadening effects","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"In the one-dimensional case – say along the x-axis –, the speed of molecules is distributed according to the Maxwell-Boltzmann distribution:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"f(v_x) = sqrtfracm2pi kTexpleft(-fracmv_x^22kTright)","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"where m is the particle mass, k is the Boltzmann constant, and T is thermodynamic temperature.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"We can thus define a Doppler width Delta nu_D as","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Delta nu_D = fracnu_0csqrtfrac2kTm= fracnu_0csqrtfrac2RTM","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"which yields the following line-shape:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"phi_D(nu) = frac1Delta nu_D sqrtpiexpleft(-frac(nu-nu_0)^2Delta nu^2_Dright)","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"which is a Gaussian distribution with Delta nu_D representing the standard deviation.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Let us put in some numbers with R=8.3144598 J/K/mol at 6000cm^-1:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"T = 220K, 290K","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"M = 16g/mol (CH4) or 44g/mol (CO_2)","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Delta nu_D(290KCO_2)=00066cm^-1","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Delta nu_D(220KCO_2)=00058cm^-1","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Delta nu_D(290KCH_4)=00110cm^-1","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Delta nu_D(290KCH_4)=00096cm^-1","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Multitply with about 1.6585 (2sqrtln(2)) to get the full-width half-maximum (FWHM) of the spectral line.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#Natural-broadening","page":"Absorption: Spectral Line Shapes","title":"Natural broadening","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"The Heisenberg uncertainty principle tells us that there is an uncertainty in the Energy:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Delta E Delta t sim h2pi","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"As Delta E is hDeltanu, we can write:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Deltanu = frach2pitau","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"The natural line-width is defined by using the resulting radiative lifetime, but this is mostly negligible as the natural lifetime of the upper state is usually much much smaller than the \"perturbed\" lifetime in the presence of quencher (e.g. through collisions or doppler broadening). Again, there are exceptions.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#Collisional-broadening","page":"Absorption: Spectral Line Shapes","title":"Collisional broadening","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Collisions between molecules quench the excited state and thus reduce the lifetime of the upper state, resulting in a widening of the line width. This behavor gives rise to the so-called Lorentz lineshape.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"phi_L(nu) = fracalpha_Lpi left(nu-nu_0)^2+alpha_L^2right","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"alpha_L depends linearly on the number density of the perturbing molecules and the relative speed of the collision partners (thus scales linearly with pressure and with sqrtT, basically both density and velocity affect the number of collisions per time). We often call this type of broadening pressure broadening, caused by collisions between molecules or atoms, which can supply or remove small amounts of energy during radiative transitions, thereby allowing photons with a broader range of frequencies to produce a particular transition of a molecule.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#Voigt-lineshape","page":"Absorption: Spectral Line Shapes","title":"Voigt lineshape","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"The Voigt line-shape is the combination of Doppler and Lorentz broadening (convolution of the two) but cannot be evaluated analytically. However, there are numerical routines to compute it efficiently, multiple of which are implemented in vSmartMOM.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#Other-more-complex-lineshapes","page":"Absorption: Spectral Line Shapes","title":"Other more complex lineshapes","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Once you dig deeper, there are various other more complex line-shapes (and line-mixing effects), which we ignore for now as the Voigt line-shape can provide very reasonable results. See, for instance, here.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Import the required tools:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"using Plots\nusing Pkg.Artifacts\nusing vSmartMOM\nusing vSmartMOM.Absorption","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Read the HITRAN database for CO_2, using artifacts in Julia:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"co2_par      = Absorption.read_hitran(artifact(\"CO2\"), mol=2, iso=1, ν_min=6214.4, ν_max=6214.8);\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Create a Voigt model (all in CPU mode)","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"line_voigt   = make_hitran_model(co2_par, Voigt(), architecture=CPU())","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Create a Doppler model","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"line_doppler = make_hitran_model(co2_par, Doppler(), architecture=CPU())","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Create a Lorentz model","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"line_lorentz = make_hitran_model(co2_par, Lorentz(), architecture=CPU())\n# Specify our wavenumber grid\nν = 6210:0.001:6220;\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Here we compute the cross sections at different pressures (in hPa, 3rd argument) and temperatures (in K, 4th argument)","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"cs_co2_1atm   = absorption_cross_section(line_voigt, ν, 1013.0     , 296.0);\ncs_co2_075atm = absorption_cross_section(line_voigt, ν, 0.75*1013.0, 296.0);\ncs_co2_05atm  = absorption_cross_section(line_voigt, ν, 0.5*1013.0 , 296.0);\ncs_co2_025atm = absorption_cross_section(line_voigt, ν, 0.25*1013.0, 296.0);\ncs_co2_01atm  = absorption_cross_section(line_voigt, ν, 0.1*1013.0 , 296.0);\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Get some more line-shapes just for Doppler and Voigt to better compare the different line shapes","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"cs_co2_01atm    = absorption_cross_section(line_voigt,   ν, 0.1*1013.0 , 296.0);\ncs_co2_doppler  = absorption_cross_section(line_doppler, ν, 0.1*1013.0 , 296.0);\ncs_co2_lorentz  = absorption_cross_section(line_lorentz, ν, 0.1*1013.0 , 296.0);\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Using a scaling factor as Julia plots sometimes have issues with very small numbers!","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"ff = 1e20;\nplot(ν,  ff*cs_co2_1atm,   label=\"Voigt, 1atm\", yformatter = :scientific)\nplot!(ν, ff*cs_co2_075atm, label=\"Voigt, 0.75atm\")\nplot!(ν, ff*cs_co2_05atm,  label=\"Voigt, 0.5atm\")\nplot!(ν, ff*cs_co2_025atm, label=\"Voigt, 0.25atm\")\n\nxlims!((6214,6215.2))\nxlabel!(\"Wavenumber (cm⁻¹))\")\nylabel!(\"Absorption cross section (10⁻²⁰ cm²/molecule)\")","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"From these figures we can see how strongly the line-witdth is impacted by pressure broadening at ranges from about 250hPa to 1013hPa. Especially the line wings are substantially widened, which is typical of Lorentz line-shapes.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"plot( ν, cs_co2_01atm   /maximum(cs_co2_01atm) ,label=\"Voigt, 296K, 0.1atm\")\nplot!(ν, cs_co2_doppler /maximum(cs_co2_01atm) ,label=\"Doppler, 296K\")\nplot!(ν, cs_co2_lorentz /maximum(cs_co2_01atm) ,label=\"Lorentz, 296K, 0.1atm\")\nxlims!((6214.4,6214.8))\n\nylabel!(\"σ/max(σ)\")\nxlabel!(\"Wavenumber (cm⁻¹)\")\nylabel!(\"normalized absorption cross section\")","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"We can see the individual impacts of Doppler and Pressure broadening at about 100hPa, at which Doppler broadening becomes important too. Most of the shape of the wings is still dominated by pressure broadening but the center has substantial contributions from Doppler broadening as well. The Voigt shape shown here is the convolution of the Lorentz and Doppler shape.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#From-an-individual-line-to-a-band","page":"Absorption: Spectral Line Shapes","title":"From an individual line to a band","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Here, we will compute an entire band of CO_2 (a few to be precise) and look at some simple behavior, e.g. the re-distribution of individual lines in the P and R branch with changing temperature.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Load a wider spectral range","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"co2_par_band = Absorption.read_hitran(artifact(\"CO2\"), mol=2, iso=1, ν_min=6000.0, ν_max=6400.0);\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Create a Voigt model for that","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"band_voigt   = make_hitran_model(co2_par_band , Voigt(), architecture=CPU());\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Define the wavenumber grid and compute cross sections at the same pressure but different temperature:","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"ν_band = 6300:0.01:6400;\nσ_co2_Voigt220 = absorption_cross_section(band_voigt, ν_band, 1013.0 , 220.0);\nσ_co2_Voigt290 = absorption_cross_section(band_voigt, ν_band, 1013.0 , 290.0);\nnothing #hide","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"plot( ν_band, ff*σ_co2_Voigt220, alpha=0.5, label=\"220K\")\nplot!(ν_band, ff*σ_co2_Voigt290, alpha=0.5, label=\"290K\")\nxlims!((6300,6380))","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"This is still a bit hard to see as the differences are relatively subtle. However, we can already see that absorptions near the band center are stronger at lower temperatures, which the opposite is true at higher rotational states. This behavior is cause by the distribution of lower rotational states, which only occupy higher Js at higher temperatures. This picture becomes more clear if we look at differences.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"plot(ν_band, ff*(σ_co2_Voigt220 - σ_co2_Voigt290), label=\"220K-290K\")\nxlims!((6300,6380))","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"Now we can clearly see how the change in the distibution of the lower rotational state leads to a redistribution of cross sections (a shift from lower to higher ground states with higher T)","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/#Some-fun-stuff","page":"Absorption: Spectral Line Shapes","title":"Some fun stuff","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/#We-can-make-use-of-advanced-animation-tools-(@gif,-@animate)-in-Julia-to-quickly-create-animations-to-show-the-impact-of-pressure-and-temperature:","page":"Absorption: Spectral Line Shapes","title":"We can make use of advanced animation tools (@gif, @animate) in Julia to quickly create animations to show the impact of pressure and temperature:","text":"","category":"section"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"T = 290.0\n@gif for p = 10:10:1100\n    σ = absorption_cross_section(band_voigt, ν_band, p , T);\n    plot(ν_band, ff*σ, yaxis=:log,label=\"p=$p\")\n    ylims!((1e-7, 1e-1))\nend","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"p = 900.0\n@gif for T = 10:10:320\n    σ = absorption_cross_section(band_voigt, ν_band, p , T);\n    plot(ν_band, ff*σ, yaxis=:log, label=\"T=$T\")\n    ylims!((1e-7, 1e-1))\nend","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"# More extreme case, let's take 10 atmospheres (10,000hPa)\nσ = absorption_cross_section(band_voigt, ν_band, 10000.0 , 300.0);\nplot(ν_band, ff*σ, label=\"p=10000.0hPa\")","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"We can see that individual lines can be blurred at very high pressures once the broadening becomes wider than the line spacing.","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"","category":"page"},{"location":"pages/tutorials/Tutorial_Absorption/","page":"Absorption: Spectral Line Shapes","title":"Absorption: Spectral Line Shapes","text":"This page was generated using Literate.jl.","category":"page"},{"location":"pages/Absorption/Overview/#Absorption-Module-Overview","page":"Overview","title":"Absorption Module Overview","text":"","category":"section"},{"location":"pages/Absorption/Overview/","page":"Overview","title":"Overview","text":"This module enables absorption cross-section calculations of atmospheric gases at different pressures, temperatures, and broadeners (Doppler, Lorentzian, Voigt). It uses the HITRAN energy transition database for calculations. ","category":"page"},{"location":"pages/Absorption/Overview/","page":"Overview","title":"Overview","text":"While it enables lineshape calculations from scratch, the module also allows users to create and save an interpolator object at specified wavelength, pressure, and temperature grids. ","category":"page"},{"location":"pages/Absorption/Overview/","page":"Overview","title":"Overview","text":"The module also supports auto-differentiation (AD) of the profile, with respect to pressure and temperature. Calculations can be computed either on CPU or GPU (CUDA). ","category":"page"},{"location":"pages/Absorption/Overview/","page":"Overview","title":"Overview","text":"Users can calculate an absorption cross-section in a few simple steps: ","category":"page"},{"location":"pages/Absorption/Overview/","page":"Overview","title":"Overview","text":"First, download HITRAN line transitions file either using artifact, or manually\nUse read_hitran to read in the HITRAN database file \nUse make_hitran_model or make_interpolation_model to set up model parameters for the cross-section calculation\nUse absorption_cross_section to perform the cross-section calculation using the defined model settings","category":"page"},{"location":"pages/Absorption/Overview/","page":"Overview","title":"Overview","text":"For a full demo of how to use this module, please see the example page. ","category":"page"},{"location":"pages/Absorption/Overview/#Architecture","page":"Overview","title":"Architecture","text":"","category":"section"},{"location":"pages/Absorption/Overview/","page":"Overview","title":"Overview","text":"(Image: ArchitectureDiagram)","category":"page"},{"location":"pages/Absorption/Overview/","page":"Overview","title":"Overview","text":"The Absorption.jl architecture closely follows the user's workflow to calculate the absorption cross-section. There are functions for loading a HITRAN line-list, defining profile parameters, and performing the calculation. ","category":"page"},{"location":"pages/Absorption/Overview/","page":"Overview","title":"Overview","text":"Please note that calculating an absorption cross-section from scratch and creating an interpolation model relies on the same underlying compute_absorption_section function. This is where the main broadening equations are implemented. The interpolation model simply calls this function for all points on the pressure-temperature grids, and produces the interpolator object. This function was mainly designed for internal use, so users should generally use the absorption_cross_section function instead. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/#RT-Parameters-Guide","page":"User-Defined RT Parameters","title":"RT Parameters Guide","text":"","category":"section"},{"location":"pages/vSmartMOM/InputParametersGuide/#**radiative_transfer**-group","page":"User-Defined RT Parameters","title":"radiative_transfer group","text":"","category":"section"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"spec_bands: List of spectral bands to be included in the computation, written in the form, ν_start:ν_step:ν_end. Units in cm⁻¹. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"surface: Type of reflectance surface to model at bottom of atmosphere. Currently only supporting Lambertian surface types. Should be written in the form, LambertianSurfaceScalar(albedo). ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"quadrature_type: Quadrature type for RT streams. Should be one among [RadauQuad, GaussQuadHemisphere, GaussQuadFullSphere].","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"polarization_type: Level of polarization to simulate. Should be one among [I, IQ, IQU, IQUV].","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"max_m: Hard cutoff for maximum number of Fourier moments to loop over. Should be a positive integer. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"Δ_angle: Exclusion angle for forward peak in phase truncation. Units in degrees. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"l_trunc: Truncation length for legendre terms. Should be a positive integer. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"depol: Depolarization factor to use in Rayleigh calculations (unitless). ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"float_type: Float type to use in the RT simulations. Should be one of [Float64, Float32]. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"architecture: Hardware architecture to use for calculations. Should be one among [CPU, GPU].","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/#**geometry**-group","page":"User-Defined RT Parameters","title":"geometry group","text":"","category":"section"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"sza: Solar zenith angle, units in degrees. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"vza: List of viewing zenith angles, units in degrees. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"vaz: List of viewing azimuthal angles, units in degrees. Should be same length as vza. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"obs_alt: Altitude of observer, in Pascal. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/#**atmospheric_profile**-group","page":"User-Defined RT Parameters","title":"atmospheric_profile group","text":"","category":"section"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"T: Temperature at each layer midpoint, as list from TOA to BOA, in Kelvin. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"p: Pressure at each layer boundary, as list from TOA to BOA, in hPa. Should be one element greater in length than T. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"q (optional): Specific humidity at each layer midpoint. Units in g/Kg. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"profile_reduction: Length of profile reduction to be performed internally. Must be positive integer less than length of T, or -1 for no reduction. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/#**absorption**-group-(optional)","page":"User-Defined RT Parameters","title":"absorption group (optional)","text":"","category":"section"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"molecules: Which molecules should be used for absorption calculations in each band. Should be a list of lists of molecule names (outer list over number of bands, inner list to hold molecules). Use vSmartMOM.Absorption.show_molecules() to see a list of valid molecules. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"vmr: A dictionary of volume-mixing ratios that match every individual molecule listed in molecules to a vmr. A vmr can be either a single number, or an array to interpolate from TOA to BOA, according to the number of layers specified by the p/T grids. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"broadening_function: Type of broadening function to use in absorption calculations. Should be one of [Voigt(), Lorentz(), Doppler()]. Please note the parentheses. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"CEF: Complex error function for Voigt calculations. Default should generally be used, HumlicekWeidemann32SDErrorFunction(). Please see Absorption/complexerrorfunctions.jl for details. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"wing_cutoff: Wing cutoff to use in the line-by-line absorption calculations. Should be a positive number in units, cm⁻¹. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/#**scattering**-group-(optional)","page":"User-Defined RT Parameters","title":"scattering group (optional)","text":"","category":"section"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"aerosols: A list of scattering aerosols and their properties. Each aerosol should be a dictionary of key-value pairs for the following keys: ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"τ_ref: Reference τ, in µm\nμ: Log mean radius, in µm\nσ: Log stddev of radius, in µm\nnᵣ: Real part of refractive index (unitless)\nnᵢ: Imaginary part of refractive index (unitless)\np₀: Pressure peak, in Pa\nσp: Pressure peak width, in Pa","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"r_max: Maximum aerosol particle radius for quadrature points/weights. Units in µm. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"nquad_radius: Number of quadrature points for aerosol radius. Should be a positive integer.","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"λ_ref: Reference wavelength. Units in µm. ","category":"page"},{"location":"pages/vSmartMOM/InputParametersGuide/","page":"User-Defined RT Parameters","title":"User-Defined RT Parameters","text":"decomp_type: Fourier decomposition method to use. Should be one of [NAI2(), PCW()]. NAI2 should be used for most cases. Please note the parentheses. ","category":"page"},{"location":"pages/vSmartMOM/References/#vSmartMOM-Module-References","page":"References","title":"vSmartMOM Module References","text":"","category":"section"},{"location":"pages/vSmartMOM/References/","page":"References","title":"References","text":"1. Sanghavi, S., Davis, A.B. and Eldering, A., 2014. vSmartMOM: A vector matrix operator \nmethod-based radiative transfer model linearized with respect to aerosol properties. Journal of \nQuantitative Spectroscopy and Radiative Transfer, 133, pp.412-433.\n\n2. Sanghavi, S. and Stephens, G., 2015. Adaptation of the delta-m and δ-fit truncation methods \nto vector radiative transfer: Effect of truncation on radiative transfer accuracy. Journal of \nQuantitative Spectroscopy and Radiative Transfer, 159, pp.53-68.\n\n3. Grant, I.P. and Hunt, G.E., 1969. Discrete space theory of radiative transfer I. \nFundamentals. Proceedings of the Royal Society of London. A. Mathematical and Physical Sciences, \n313(1513), pp. 183-197.\n\n4. Plass, G.N., Kattawar, G.W. and Catchings, F.E., 1973. Matrix operator theory of radiative \ntransfer. 1: Rayleigh scattering. Applied Optics, 12(2), pp.314-329.","category":"page"},{"location":"pages/vSmartMOM/Overview/#vSmartMOM-Module-Overview","page":"Overview","title":"vSmartMOM Module Overview","text":"","category":"section"},{"location":"pages/vSmartMOM/Overview/","page":"Overview","title":"Overview","text":"The vSmartMOM module allows end-to-end simulation of radiative transfer (RT) throughout Earth's atmosphere as well as atmospheres of stars and substellar objects like brown dwarfs and exoplanets. Specifically, the module:","category":"page"},{"location":"pages/vSmartMOM/Overview/","page":"Overview","title":"Overview","text":"Enables 1D vectorized plane-parallel RT modeling based on the Matrix Operator Method, also known as Discrete Space Theory (please see the references for source papers). \nIncorporates fast, high-fidelity simulations of scattering atmospheres containing haze and clouds, including pressure- and temperature-resolved absorption profiles of gaseous species in the atmosphere\nEnables GPU-accelerated computations of the resulting hyperspectral reflectances/transmittances\nEnables auto-differentiation of the output spectrum with respect to various input parameters","category":"page"},{"location":"pages/vSmartMOM/Overview/","page":"Overview","title":"Overview","text":"You can perform an RT simulation in a few short steps: ","category":"page"},{"location":"pages/vSmartMOM/Overview/","page":"Overview","title":"Overview","text":"Use parameters_from_yaml or default_parameters to load a set of RT input parameters. You can modify any parameter in the returning vSmartMOM_Parameters struct (it is mutable). Please see the parameters guide for more information on what each field specifies. \nUse model_from_parameters to calculate derived fields (ex. aerosol optical parameters, quadrature points, etc.). Again, any parameter in the output vSmartMOM_Model can be modified after the struct is created. \nUse rt_run to perform the radiative transfer calculation using the defined model settings. ","category":"page"},{"location":"pages/vSmartMOM/Overview/","page":"Overview","title":"Overview","text":"For a full demo of how to use this module, please see the example page. ","category":"page"},{"location":"pages/vSmartMOM/Overview/#Architecture","page":"Overview","title":"Architecture","text":"","category":"section"},{"location":"pages/vSmartMOM/Overview/","page":"Overview","title":"Overview","text":"(Image: ArchitectureDiagram)","category":"page"},{"location":"pages/Scattering/Example/#Scattering-Module-Example","page":"Example","title":"Scattering Module Example","text":"","category":"section"},{"location":"pages/Scattering/Example/","page":"Example","title":"Example","text":"using vSmartMOM\nusing vSmartMOMYeah.Scattering\nusing Distributions\nusing BenchmarkTools\n\n## \n## STEP 1: Create the Aerosol\n## \n\n# Aerosol particle distribution and properties \nμ  = 0.3                # Log mean radius (μm)\nσ  = 6.82               # Log stddev of radius (μm)\nr_max = 30.0            # Maximum radius (μm)\nnquad_radius = 2500     # Number of quadrature points for integrating of size dist.\nnᵣ = 1.3                # Real part of refractive index\nnᵢ = 0.0                # Imag part of refractive index\n\nsize_distribution = LogNormal(log(μ), log(σ))\n\n# Create the aerosol\naero = Aerosol(size_distribution, nᵣ, nᵢ)\n\n## \n## STEP 2: Create the Mie Calculations model\n## \n\nλ = 0.55        # Incident wavelength (μm)\npolarization_type = Stokes_IQUV()  \nl_max = 10      # Trunction length for legendre terms\nΔ_angle = 2     # Exclusion angle for forward peak (in fitting procedure) `[degrees]`\ntruncation_type = δBGE(l_max, Δ_angle)\n\n# NAI2 Method\nmodel_NAI2 = make_mie_model(NAI2(), aero, λ, polarization_type, truncation_type, r_max, nquad_radius)\n\n# PCW Method with saved/loaded Wigner tables\nwigner_file_path = \"PATH_TO_SAVED_WIGNER_MATRIX\"\nmodel_PCW = make_mie_model(PCW(), aero, λ, polarization_type, truncation_type, r_max, nquad_radius, wigner_file_path)\n\n# PCW Method with newly computed Wigner tables\nwigner_A, wigner_B = compute_wigner_values(600) # Specify N_max\nmodel_PCW_computed_wigner = make_mie_model(PCW(), aero, λ, polarization_type, truncation_type, wigner_A, wigner_B)\n\n## \n## STEP 3: Perform the Mie Calculations\n## \n\naerosol_optics_NAI2 = compute_aerosol_optical_properties(model_NAI2);\naerosol_optics_PCW = compute_aerosol_optical_properties(model_PCW);\n\n# To perform auto-differentiation w.r.t. μ, σ, nᵣ, nᵢ\naerosol_optics_NAI2_AD, derivs = compute_aerosol_optical_properties(model_NAI2, autodiff=true);\n\n## \n## STEP 4: Obtain Scattering Matrix\n## \n\nμ_quad, w_μ = gausslegendre(1000); # Quadrature points/weights\nscattering_matrix = reconstruct_phase(aerosol_optics_NAI2.greek_coefs, μ_quad);\n","category":"page"},{"location":"pages/vSmartMOM/Example/#vSmartMOM-Module-Example","page":"Example","title":"vSmartMOM Module Example","text":"","category":"section"},{"location":"pages/vSmartMOM/Example/","page":"Example","title":"Example","text":"using vSmartMOM\nusing vSmartMOM.CoreRT\n\n## \n## STEP 1: Load / Customize RT parameters\n## \n\n# If you would like to load your own parameters from a YAML file\n# (See required format at: https://github.com/remotesensingtools/vSmartMOM.jl/blob/main/src/CoreRT/DefaultParameters.yaml)\nparameters = parameters_from_yaml(\"vSmartMOM/src/CoreRT/DefaultParameters.yaml\")\n\n# OR if you would like to load a default set of parameters\nparameters = default_parameters();\n\n# You can then change any individual fields in parameters (parameters.field = ...)\n# Please see descriptions of each field here: \n# https://remotesensingtools.github.io/vSmartMOM.jl/dev/pages/vSmartMOM/InputParametersGuide/\n\n## \n## STEP 2: Create a model from parameters\n## \n\n# Creating this model will use the parameters object to calculate derived fields and attributes\nmodel = model_from_parameters(parameters);\n\n# Again, you can then change any derived field in model (model.field = ...)\n\n## \n## STEP 3: Run the RT simulation\n## \n\nR = rt_run(model)\n","category":"page"},{"location":"pages/vSmartMOM/Types/#vSmartMOM-Module-Methods-and-Types","page":"Methods & Types","title":"vSmartMOM Module Methods & Types","text":"","category":"section"},{"location":"pages/vSmartMOM/Types/#Defining-Parameters-for-RT-Simulation","page":"Methods & Types","title":"Defining Parameters for RT Simulation","text":"","category":"section"},{"location":"pages/vSmartMOM/Types/","page":"Methods & Types","title":"Methods & Types","text":"parameters_from_yaml\ndefault_parameters","category":"page"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.parameters_from_yaml","page":"Methods & Types","title":"vSmartMOM.CoreRT.parameters_from_yaml","text":"Given a path to a YAML parameters file, load all the parameters into a vSmartMOM_Parameters struct\n\n\n\n\n\n","category":"function"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.default_parameters","page":"Methods & Types","title":"vSmartMOM.CoreRT.default_parameters","text":"Generate default set of parameters for Radiative Transfer calculations (from ModelParameters/)\n\n\n\n\n\n","category":"function"},{"location":"pages/vSmartMOM/Types/#Using-the-Parameters-Object-to-Create-a-Model","page":"Methods & Types","title":"Using the Parameters Object to Create a Model","text":"","category":"section"},{"location":"pages/vSmartMOM/Types/","page":"Methods & Types","title":"Methods & Types","text":"model_from_parameters","category":"page"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.model_from_parameters","page":"Methods & Types","title":"vSmartMOM.CoreRT.model_from_parameters","text":"Take the parameters specified in the vSmartMOMParameters struct, and calculate derived attributes into a vSmartMOMModel\n\n\n\n\n\n","category":"function"},{"location":"pages/vSmartMOM/Types/#Performing-the-RT-Simulation","page":"Methods & Types","title":"Performing the RT Simulation","text":"","category":"section"},{"location":"pages/vSmartMOM/Types/","page":"Methods & Types","title":"Methods & Types","text":"rt_run","category":"page"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.rt_run","page":"Methods & Types","title":"vSmartMOM.CoreRT.rt_run","text":"rt_run(pol_type, obs_geom::ObsGeometry, τ_rayl, τ_aer, quad_points::QuadPoints, max_m, aerosol_optics, greek_rayleigh, τ_abs, brdf, architecture::AbstractArchitecture)\n\nPerform Radiative Transfer calculations using given parameters\n\n\n\n\n\nrt_run(model::vSmartMOM_Model, i_band::Integer = -1)\n\nPerform Radiative Transfer calculations using parameters passed in through the  vSmartMOM_Model struct\n\n\n\n\n\n","category":"function"},{"location":"pages/vSmartMOM/Types/#Types","page":"Methods & Types","title":"Types","text":"","category":"section"},{"location":"pages/vSmartMOM/Types/#Parameters-Type","page":"Methods & Types","title":"Parameters Type","text":"","category":"section"},{"location":"pages/vSmartMOM/Types/","page":"Methods & Types","title":"Methods & Types","text":"CoreRT.vSmartMOM_Parameters","category":"page"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.vSmartMOM_Parameters","page":"Methods & Types","title":"vSmartMOM.CoreRT.vSmartMOM_Parameters","text":"struct vSmartMOM_Parameters\n\nA struct which holds all initial model parameters (before any computations)\n\nFields\n\nspec_bands\nSpectral bands (nBand)\nbrdf\nSurface (Bidirectional Reflectance Distribution Function)\nquadrature_type\nQuadrature type for RT streams (RadauQuad/GaussQuadHemisphere/GaussQuadFullSphere)\npolarization_type\nType of polarization (I/IQ/IQU/IQUV)\nmax_m\nHard cutoff for maximum number of Fourier moments to loop over\nΔ_angle\nExclusion angle for forward peak [deg]\nl_trunc\nTruncation length for legendre terms (scalar for now, can do nBand later)\ndepol\nDepolarization factor\nfloat_type\nFloat type to use in the RT (Float64/Float32)\narchitecture\nArchitecture to use for calculations (CPU/GPU)\nsza\nSolar zenith angle [deg]\nvza\nViewing zenith angles [deg]\nvaz\nViewing azimuthal angles [deg]\nobs_alt\nAltitude of observer [Pa]\nT\nTemperature Profile [K]\np\nPressure Profile [hPa]\nq\nSpecific humidity profile\nprofile_reduction_n\nLength of profile reduction\nabsorption_params\nOptional struct that holds all absorption-related parameters\nscattering_params\nOptional struct that holds all aerosol scattering-related parameters\n\n\n\n\n\n","category":"type"},{"location":"pages/vSmartMOM/Types/#Model-Type","page":"Methods & Types","title":"Model Type","text":"","category":"section"},{"location":"pages/vSmartMOM/Types/","page":"Methods & Types","title":"Methods & Types","text":"CoreRT.vSmartMOM_Model","category":"page"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.vSmartMOM_Model","page":"Methods & Types","title":"vSmartMOM.CoreRT.vSmartMOM_Model","text":"struct vSmartMOM_Model\n\nA struct which holds all derived model parameters (including any computations)\n\nFields\n\nparams\nStruct with all individual parameters\naerosol_optics\nTruncated aerosol optics\ngreek_rayleigh\nGreek coefs in Rayleigh calculations\nquad_points\nQuadrature points/weights, etc\nτ_abs\nArray to hold cross-sections over entire atmospheric profile\nτ_rayl\nRayleigh optical thickness\nτ_aer\nAerosol optical thickness\nobs_geom\nObservational Geometry (includes sza, vza, vaz)\nprofile\nAtmospheric profile to use\n\n\n\n\n\n","category":"type"},{"location":"pages/vSmartMOM/Types/#Surface-Types","page":"Methods & Types","title":"Surface Types","text":"","category":"section"},{"location":"pages/vSmartMOM/Types/","page":"Methods & Types","title":"Methods & Types","text":"CoreRT.AbstractSurfaceType\nCoreRT.LambertianSurfaceScalar\nCoreRT.LambertianSurfaceSpectrum\n","category":"page"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.AbstractSurfaceType","page":"Methods & Types","title":"vSmartMOM.CoreRT.AbstractSurfaceType","text":"Abstract Type for Surface Types\n\n\n\n\n\n","category":"type"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.LambertianSurfaceScalar","page":"Methods & Types","title":"vSmartMOM.CoreRT.LambertianSurfaceScalar","text":"Lambertian Surface (scalar per band)\n\n\n\n\n\n","category":"type"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.LambertianSurfaceSpectrum","page":"Methods & Types","title":"vSmartMOM.CoreRT.LambertianSurfaceSpectrum","text":"Defined as Array (has to have the same length as the band!)\n\n\n\n\n\n","category":"type"},{"location":"pages/vSmartMOM/Types/#Quadrature-Types","page":"Methods & Types","title":"Quadrature Types","text":"","category":"section"},{"location":"pages/vSmartMOM/Types/","page":"Methods & Types","title":"Methods & Types","text":"CoreRT.AbstractQuadratureType\nCoreRT.RadauQuad\nCoreRT.GaussQuadHemisphere\nCoreRT.GaussQuadFullSphere\n","category":"page"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.AbstractQuadratureType","page":"Methods & Types","title":"vSmartMOM.CoreRT.AbstractQuadratureType","text":"Quadrature Types for RT streams\n\n\n\n\n\n","category":"type"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.RadauQuad","page":"Methods & Types","title":"vSmartMOM.CoreRT.RadauQuad","text":"struct RadauQuad\n\nUse Gauss Radau quadrature scheme, which includes the SZA as point (see Sanghavi vSmartMOM)\n\n\n\n\n\n","category":"type"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.GaussQuadHemisphere","page":"Methods & Types","title":"vSmartMOM.CoreRT.GaussQuadHemisphere","text":"struct GaussQuadHemisphere\n\nUse Gauss quadrature scheme, define interval [-1,1] within an hemisphere (90⁰), repeat for both\n\n\n\n\n\n","category":"type"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.GaussQuadFullSphere","page":"Methods & Types","title":"vSmartMOM.CoreRT.GaussQuadFullSphere","text":"struct GaussQuadFullSphere\n\nUse Gauss quadrature scheme, define interval [-1,1] for full sphere (180⁰), take half of it (less points near horizon compared to GaussQuadHemisphere)\n\n\n\n\n\n","category":"type"},{"location":"pages/vSmartMOM/Types/#Atmospheric-Profile-Type","page":"Methods & Types","title":"Atmospheric Profile Type","text":"","category":"section"},{"location":"pages/vSmartMOM/Types/","page":"Methods & Types","title":"Methods & Types","text":"CoreRT.AtmosphericProfile","category":"page"},{"location":"pages/vSmartMOM/Types/#vSmartMOM.CoreRT.AtmosphericProfile","page":"Methods & Types","title":"vSmartMOM.CoreRT.AtmosphericProfile","text":"Struct for an atmospheric profile\n\n\n\n\n\n","category":"type"},{"location":"pages/Absorption/References/#Absorption-Module-References","page":"References","title":"Absorption Module References","text":"","category":"section"},{"location":"pages/Absorption/References/","page":"References","title":"References","text":"1. Gordon, I.E., Rothman, L.S., Hill, C., Kochanov, R.V., Tan, Y., Bernath, P.F., Birk, M., \nBoudon, V., Campargue, A., Chance, K.V. and Drouin, B.J., 2017. The HITRAN2016 molecular \nspectroscopic database. Journal of Quantitative Spectroscopy and Radiative Transfer, 203, pp.\n3-69.\n\n2. Kochanov, R.V., Gordon, I.E., Rothman, L.S., Wcisło, P., Hill, C. and Wilzewski, J.S., 2016. \nHITRAN Application Programming Interface (HAPI): A comprehensive approach to working with \nspectroscopic data. Journal of Quantitative Spectroscopy and Radiative Transfer, 177, pp.15-30.\n\n3. Schreier, F., 2011. Optimized implementations of rational approximations for the Voigt and \ncomplex error function. Journal of Quantitative Spectroscopy and Radiative Transfer, 112(6), pp.\n1010-1025.","category":"page"},{"location":"pages/Absorption/Example/#Absorption-Module-Example","page":"Example","title":"Absorption Module Example","text":"","category":"section"},{"location":"pages/Absorption/Example/","page":"Example","title":"Example","text":"using vSmartMOM\nusing vSmartMOM.Absorption\n\n## \n## STEP 1: Get the Hitran data\n## \n\n# If you have a fixed-width file stored locally\nhitran_data = read_hitran(\"path/to/file\", mol=2, iso=1, ν_min=6000, ν_max=6400)\n\n# If you would like to download the file from the hitran database\nhitran_data = read_hitran(artifact(\"CO2\"), mol=2, iso=1, ν_min=6000, ν_max=6400)\n# For a list of available molecules, use Absorption.show_molecules()\n\n## \n## STEP 2: Create a model from parameters\n## \n\n# These are some example models, but you can create/customize your model however you'd like. \n# Please see make_hitran_model documentation for optional arguments\nmodel_doppler = make_hitran_model(hitran_data, Doppler())\nmodel_lorentz = make_hitran_model(hitran_data, Lorentz())\nmodel_voigt_CPU = make_hitran_model(hitran_data, Voigt())\nmodel_voigt_GPU = make_hitran_model(hitran_data, Voigt(), architecture=Architectures.GPU())\n\n# If you would prefer to create an interpolation, and then interpolate the cross-section \n# at other wavelengths/pressures/temperatures, you can use make_interpolation_model as such:\n\nν_grid = 6000:0.01:6400\npressures = 250:250:1250\ntemperatures = 100:75:400\n\nmodel_interp = make_interpolation_model(hitran_data, Voigt(), ν_grid, pressures, temperatures)\n\n# Note: please see make_interpolation_model documentation for optional parameters\n\n## \n## STEP 3: Calculate the absorption cross section with the created model\n## \n\n# NOTE: Please replace the \"model_*\" in the following lines with whichever model option you prefer from Step 2\n\n# You can specify the wavelength grid, pressure, and temperature. \nprofile = absorption_cross_section(model_*, 6000:0.01:6400, 1000.1, 296.1)\n\n# You can obtain the derivatives of the cross-section by setting the autodiff parameter to true: \nprofile, derivs = absorption_cross_section(model_*, 6000:0.01:6400, 1000.1, 296.1, autodiff=true);\n","category":"page"},{"location":"#Introduction","page":"Getting Started","title":"Introduction","text":"","category":"section"},{"location":"","page":"Getting Started","title":"Getting Started","text":"vSmartMOM.jl aims to revamp and modernize key atmospheric remote sensing tools. Specifically, it will enable the fast computation of atmospheric optical properties, full-polarized radiative transfer simulations, and commonly-used inversion routines. ","category":"page"},{"location":"","page":"Getting Started","title":"Getting Started","text":"By taking advantage of modern software tools, such as GPU acceleration and HPC computing, the software suite significantly accelerates computationally intensive calculations and models, while keeping the interface easy to use for researchers and students.","category":"page"},{"location":"#Installation","page":"Getting Started","title":"Installation","text":"","category":"section"},{"location":"","page":"Getting Started","title":"Getting Started","text":"Install Julia (1.6+)\nStart the Julia REPL, enter the Pkg REPL by pressing ], and run:  ","category":"page"},{"location":"","page":"Getting Started","title":"Getting Started","text":"add vSmartMOM","category":"page"},{"location":"#Submodules","page":"Getting Started","title":"Submodules","text":"","category":"section"},{"location":"","page":"Getting Started","title":"Getting Started","text":"vSmartMOM.jl has a modular architecture, allowing users to import just the specific module(s) that they need: ","category":"page"},{"location":"","page":"Getting Started","title":"Getting Started","text":"vSmartMOM is the top-level module that uses absorption and scattering submodules to compute RT simulations. ","category":"page"},{"location":"","page":"Getting Started","title":"Getting Started","text":"Absorption is used for computing absorption cross-sections for gases over specified pressure, temperature, and wavelength grids. \nScattering is used for calculating scattering phase-functions for aerosols with specified size distributions and refractive indices. ","category":"page"},{"location":"#How-to-use-the-documentation","page":"Getting Started","title":"How to use the documentation","text":"","category":"section"},{"location":"","page":"Getting Started","title":"Getting Started","text":"Each module has a set of documentation pages, as seen on the navigation bar. Each module's documentation contains a high-level overview of the module, an example of the module in use, a list of key methods and types, and a list of academic references. ","category":"page"},{"location":"","page":"Getting Started","title":"Getting Started","text":"The vSmartMOM module's documentation additionally has a guide to all the user-defined RT parameters that can be modified. ","category":"page"},{"location":"","page":"Getting Started","title":"Getting Started","text":"Finally, there are tutorials that combine text, equations, code, and plots to demonstrate uses of the submodules. ","category":"page"},{"location":"pages/Scattering/Overview/#Scattering-Module-Overview","page":"Overview","title":"Scattering Module Overview","text":"","category":"section"},{"location":"pages/Scattering/Overview/","page":"Overview","title":"Overview","text":"This module enables scattering phase-function calculation of atmospheric aerosols with different size distributions, incident wavelengths, and refractive indices. It can perform the calculation using either the Siewert NAI-2 or Domke PCW methods (Suniti Sanghavi 2014). ","category":"page"},{"location":"pages/Scattering/Overview/","page":"Overview","title":"Overview","text":"The module also supports auto-differentiation (AD) of the phase function, with respect to the aerosol's size distribution parameters and its refractive index. ","category":"page"},{"location":"pages/Scattering/Overview/","page":"Overview","title":"Overview","text":"You can calculate a scattering phase-function in a few short steps: ","category":"page"},{"location":"pages/Scattering/Overview/","page":"Overview","title":"Overview","text":"Use Aerosol to create an aerosol with selected distribution and properties\nUse make_mie_model to set up all calculation parameters\nUse compute_aerosol_optical_properties to perform the optical-properties calculations using the defined model settings\nUse reconstruct_phase to produce the scattering matrix from the computed optical properties","category":"page"},{"location":"pages/Scattering/Overview/","page":"Overview","title":"Overview","text":"For a full demo of how to use this module, please see the example page. ","category":"page"},{"location":"pages/Scattering/Overview/#Architecture","page":"Overview","title":"Architecture","text":"","category":"section"},{"location":"pages/Scattering/Overview/","page":"Overview","title":"Overview","text":"(Image: ArchitectureDiagram)","category":"page"},{"location":"pages/Scattering/Overview/","page":"Overview","title":"Overview","text":"The Scattering.jl architecture closely follows the user's workflow to calculate the scattering phase-function. There are functions for creating an aerosol, defining scattering parameters, calculating aerosol optical properties, and constructing the phase-function from said optical properties. ","category":"page"},{"location":"pages/Scattering/Overview/","page":"Overview","title":"Overview","text":"The aerosol optical properties contain computed \"Greek Coefficients\", which are to be multiplied by matrices composed of generalized spherical functions, in order to produce the phase-functions. Since calculating the greek coefficients is the most computationally intensive part – and the output phase-function can be produced at various resolutions – the reconstruct_phase function is separate from compute_aerosol_optical_properties. ","category":"page"}]
}
